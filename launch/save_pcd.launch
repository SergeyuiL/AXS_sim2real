<launch>
    <param name="use_sim_time" value="true" />
    <arg name="play_bagfile" default="$(find sim2real)/rosbag/0424/remote_control_move.bag"/>
    <arg name="pcd_output_directory" default="$(find sim2real)/pcdmaps/0424"/>

    <!-- rosbag play -->
    <node name="player" pkg="rosbag" type="play" output="screen" args="--clock --rate=1.0 $(arg play_bagfile)" />

    <!-- Point Cloud Assembler -->
    <node pkg="laser_assembler" type="laser_scan_assembler" name="laser_scan_assembler">
        <remap from="scan" to="/livox/lidar"/>
        <param name="fixed_frame" value="world"/>
        <param name="max_time_per_scan" value="10.0"/> <!-- Adjust time to assemble scans -->
    </node>

    <!-- Save to PCD -->
    <node name="pointcloud_to_pcd" pkg="pcl_ros" type="pointcloud_to_pcd" output="screen">
        <param name="prefix" value="$(arg pcd_output_directory)/scans.pcd"/>
        <remap from="/input" to="assembled_cloud"/>
    </node>
</launch>
