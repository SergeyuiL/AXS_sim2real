<launch>
    <param name="use_sim_time" value="true" />
    <arg name="play_bagfile" default="$(find sim2real)/rosbag/0424/remote_contro_imagel.bag"/>
    <arg name="save_bagfile" default="$(find sim2real)/rosbag/0424/move_localization.bag"/>
    <arg name="map_dir"     default="$(find sim2real)/pcdmaps/0424"/>
    <arg name="record"  default="false"/>
    <arg name="localization"  default="true"/>
    <arg name="visual"   default="true"/>

    <!-- rosbag play -->
    <node name="player" pkg="rosbag" type="play" output="screen" args="--clock --rate=1.0 $(arg play_bagfile)" />

    <!-- tf -->
    <include file="$(find sim2real)/launch/robot_state_publisher.launch">
        <arg name="robot_description_path" value="$(find sim2real)/urdf/AIRBOT_V3_v2-3.urdf"/>
    </include>

    <!-- LIO Livox -->
    <node pkg="lio_livox" type="ScanRegistration" name="ScanRegistration" output="screen">
        <param name="config_file" value="$(find lio_livox)/config/mid360_config.yaml"/>
        <!--0-custom msg ,1 ros sensor msg pointcloud2 msg  -->
        <param name="msg_type" type="int" value="1"/>
    </node>

    <node pkg="lio_livox" type="PoseEstimation" name="PoseEstimation" output="screen">
        <!-- 0-Not Use IMU, 1-Use IMU remove Rotation Distort, 2-Tightly Coupled IMU -->
        <param name="IMU_Mode" type="int" value="0" />
        <!-- Voxel Filter Size Use to Downsize Map Cloud -->
        <param name="filter_parameter_corner" type="double" value="0.2" />
        <param name="filter_parameter_surf" type="double" value="0.4" />
        <!-- Extrinsic Parameter between Lidar & IMU -->
        <rosparam param="Extrinsic_Tlb"> [0.9999161, 0.0026676,  0.0126707, -0.011,
                                         -0.0025826, 0.9999741, -0.0067201, -0.0234,
                                         -0.0126883, 0.0066868,  0.9998971,   0.044,
                                                0.0,       0.0,        0.0,      1.0]</rosparam>
    </node>
    
    <!-- record rosbag -->
    <node if="$(arg record)" name="rosbag_record" pkg="rosbag" type="record" args="--lz4 --repeat-latched -a -O $(arg save_bagfile)" output="screen" />

    <!-- rviz -->
    <node if="$(arg visual)" name="rviz" pkg="rviz" type="rviz" args="-d $(find sim2real)/rviz/hdl_localization.rviz" required="true"/>


</launch>